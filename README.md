# Задание 1. Резервное копирование
# Кейс
## Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.
Необходимо описать, какие варианты резервного копирования подходят в случаях:
 * 1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.
     * Для этого подходит Full Backup на еждневной основе.
 * 1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.
     * Ну тут классическая комбинация Full Backup + Incremental.
 * 1.3. Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.
     * Да возможен, например в PostgreSQL есть потоковая репликация, ну и связанный с этим инструментарий (pgpool) 

# Задание 2. PostgreSQL
 * 2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).
    ``` sql
       # Создание дампа в custom-формате 
       pg_dump -Fc -U myusername -d mydatabase -f mydatabase_backup.dump
       # Создание дампа в plain-формате 
       pg_dump -U myusername -d mydatabase -f mydatabase_backup.sql

       # Восстановление из custom-формата
       pg_restore -U myusername -d mydatabase -j 4 mydatabase_backup.dump
       # Для восстановления из plain-SQL файла используется psql
       psql -U myusername -d mydatabase -f mydatabase_backup.sql
    ```
 * 2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?
   * Нагуглил про  Инструменты вроде pgBackRest или Barman. Они разработаны специально для PostgreSQL и предоставляют продвинутую автоматизацию.
   * Ну и старый добрый Bash + Crontab =)

# Задание 3. MySQL
 * 3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.
   * Сначала делаем полный бекап, потом периодически сохраняем бинарные логи.
   ``` bash
     mysqldump -u root -p --single-transaction --flush-logs --master-data=2 --all-databases > full_backup.sql
   ```
    * --flush-logs закрывает текущий бинарный лог и начинает новый. Это критически важно для инкрементного бэкапа.
    * Инкрементным бэкапом будет копирование файлов бинарных логов.
   ``` bash    
      cp /var/lib/mysql/mysql-bin.00000* /path/to/backup/
   ```
   * Вообще для подобных целей и нормальной автоматизации, я бы использовал специальные утилиты mysqlbinlog и mysqlbackup.
 
 * 3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?
   * Реплика постоянно синхронизируется с мастером, и является "горячей" копией. Т.е можно сразу на неё переключаться в слуае чего. 
   * Бекап, всё же больше для воостановления удалённого\потерянного и т.д.
   * Подводя итог: репликация решает задачу высокой доступности, а резервное копирование решает задачу восстановления после очень плохих ситуаций =) 
